<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:HoldON.ViewModels"
             xmlns:charts="clr-namespace:Microcharts.Maui;assembly=Microcharts.Maui"
             x:DataType="viewmodels:ProgressViewModel"
             x:Class="HoldON.Views.ProgressPage"
             BackgroundColor="{StaticResource Background}">

    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="20">
            <Label Text="Napredek"
                   TextColor="{StaticResource White}"
                   FontSize="28"
                   FontAttributes="Bold"/>

            <!-- Stats Summary -->
            <Grid ColumnDefinitions="*, *" ColumnSpacing="15">
                <Frame Grid.Column="0" Style="{StaticResource StrongerCard}" Padding="20">
                    <VerticalStackLayout Spacing="8">
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="ðŸ“…" FontSize="20"/>
                            <Label Text="DokonÄani treningi" TextColor="{StaticResource White}" FontSize="12"/>
                        </HorizontalStackLayout>
                        <Label Text="{Binding CompletedWorkouts}" TextColor="{StaticResource White}" FontSize="32" FontAttributes="Bold"/>
                        <Label Text="Vseh Äasov" TextColor="{StaticResource Gray400}" FontSize="12"/>
                    </VerticalStackLayout>
                </Frame>
                <Frame Grid.Column="1" Style="{StaticResource StrongerCard}" Padding="20">
                    <VerticalStackLayout Spacing="8">
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="ðŸ“ˆ" FontSize="20"/>
                            <Label Text="Skupni volumen" TextColor="{StaticResource White}" FontSize="12"/>
                        </HorizontalStackLayout>
                        <Label Text="{Binding TotalVolume}" TextColor="{StaticResource White}" FontSize="32" FontAttributes="Bold"/>
                        <Label Text="kg" TextColor="{StaticResource Tertiary}" FontSize="12" FontAttributes="Bold"/>
                    </VerticalStackLayout>
                </Frame>
            </Grid>

            <!-- Navigation Tabs -->
            <Grid ColumnDefinitions="*, *, *" ColumnSpacing="0">
                <Button Grid.Column="0"
                        Text="Pregled"
                        Command="{Binding SelectViewCommand}"
                        CommandParameter="Pregled"
                        CornerRadius="25"
                        HeightRequest="40"
                        FontAttributes="Bold"
                        Padding="0">
                    <Button.Triggers>
                        <DataTrigger TargetType="Button" Binding="{Binding SelectedViewIndex}" Value="0">
                            <Setter Property="BackgroundColor" Value="{StaticResource White}"/>
                            <Setter Property="TextColor" Value="{StaticResource Background}"/>
                        </DataTrigger>
                        <DataTrigger TargetType="Button" Binding="{Binding SelectedViewIndex}" Value="1">
                            <Setter Property="BackgroundColor" Value="Transparent"/>
                            <Setter Property="TextColor" Value="{StaticResource Gray400}"/>
                        </DataTrigger>
                        <DataTrigger TargetType="Button" Binding="{Binding SelectedViewIndex}" Value="2">
                            <Setter Property="BackgroundColor" Value="Transparent"/>
                            <Setter Property="TextColor" Value="{StaticResource Gray400}"/>
                        </DataTrigger>
                    </Button.Triggers>
                </Button>
                <Button Grid.Column="1"
                        Text="Vaje"
                        Command="{Binding SelectViewCommand}"
                        CommandParameter="Vaje"
                        CornerRadius="25"
                        HeightRequest="40"
                        FontAttributes="Bold"
                        Padding="0">
                    <Button.Triggers>
                        <DataTrigger TargetType="Button" Binding="{Binding SelectedViewIndex}" Value="0">
                            <Setter Property="BackgroundColor" Value="Transparent"/>
                            <Setter Property="TextColor" Value="{StaticResource Gray400}"/>
                        </DataTrigger>
                        <DataTrigger TargetType="Button" Binding="{Binding SelectedViewIndex}" Value="1">
                            <Setter Property="BackgroundColor" Value="{StaticResource White}"/>
                            <Setter Property="TextColor" Value="{StaticResource Background}"/>
                        </DataTrigger>
                        <DataTrigger TargetType="Button" Binding="{Binding SelectedViewIndex}" Value="2">
                            <Setter Property="BackgroundColor" Value="Transparent"/>
                            <Setter Property="TextColor" Value="{StaticResource Gray400}"/>
                        </DataTrigger>
                    </Button.Triggers>
                </Button>
                <Button Grid.Column="2"
                        Text="MoÄ"
                        Command="{Binding SelectViewCommand}"
                        CommandParameter="MoÄ"
                        CornerRadius="25"
                        HeightRequest="40"
                        FontAttributes="Bold"
                        Padding="0">
                    <Button.Triggers>
                        <DataTrigger TargetType="Button" Binding="{Binding SelectedViewIndex}" Value="0">
                            <Setter Property="BackgroundColor" Value="Transparent"/>
                            <Setter Property="TextColor" Value="{StaticResource Gray400}"/>
                        </DataTrigger>
                        <DataTrigger TargetType="Button" Binding="{Binding SelectedViewIndex}" Value="1">
                            <Setter Property="BackgroundColor" Value="Transparent"/>
                            <Setter Property="TextColor" Value="{StaticResource Gray400}"/>
                        </DataTrigger>
                        <DataTrigger TargetType="Button" Binding="{Binding SelectedViewIndex}" Value="2">
                            <Setter Property="BackgroundColor" Value="{StaticResource White}"/>
                            <Setter Property="TextColor" Value="{StaticResource Background}"/>
                        </DataTrigger>
                    </Button.Triggers>
                </Button>
            </Grid>

            <!-- Pregled View -->
            <VerticalStackLayout IsVisible="{Binding SelectedViewIndex, Converter={StaticResource EqualToConverter}, ConverterParameter=0}" Spacing="15">
                <Frame Style="{StaticResource StrongerCard}" Padding="20">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="Tedenski volumen"
                               TextColor="{StaticResource White}"
                               FontSize="18"
                               FontAttributes="Bold"/>
                        <charts:ChartView Chart="{Binding VolumeChart}" HeightRequest="250" BackgroundColor="Transparent" />
                    </VerticalStackLayout>
                </Frame>

                <Frame Style="{StaticResource StrongerCard}" Padding="20">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="Aktivnost"
                               TextColor="{StaticResource White}"
                               FontSize="18"
                               FontAttributes="Bold"/>
                        <FlexLayout BindableLayout.ItemsSource="{Binding MonthDays}"
                                    Wrap="Wrap"
                                    JustifyContent="Start"
                                    AlignContent="Start"
                                    Direction="Row">
                            <BindableLayout.ItemTemplate>
                                <DataTemplate x:DataType="viewmodels:DayActivityModel">
                                    <Frame WidthRequest="30"
                                           HeightRequest="30"
                                           Padding="0"
                                           Margin="2"
                                           CornerRadius="4"
                                           HasShadow="False"
                                           BorderColor="Transparent">
                                        <Frame.Triggers>
                                            <DataTrigger TargetType="Frame" Binding="{Binding HasWorkout}" Value="True">
                                                <Setter Property="BackgroundColor" Value="{StaticResource Tertiary}"/>
                                            </DataTrigger>
                                            <DataTrigger TargetType="Frame" Binding="{Binding HasWorkout}" Value="False">
                                                <Setter Property="BackgroundColor" Value="#1A1F2E"/>
                                            </DataTrigger>
                                        </Frame.Triggers>
                                        <Label Text="{Binding Day}"
                                               TextColor="{StaticResource White}"
                                               FontSize="10"
                                               HorizontalOptions="Center"
                                               VerticalOptions="Center"/>
                                    </Frame>
                                </DataTemplate>
                            </BindableLayout.ItemTemplate>
                        </FlexLayout>
                    </VerticalStackLayout>
                </Frame>
            </VerticalStackLayout>

            <!-- Vaje View -->
            <VerticalStackLayout IsVisible="{Binding SelectedViewIndex, Converter={StaticResource EqualToConverter}, ConverterParameter=1}" Spacing="15">
                <Frame Style="{StaticResource StrongerCard}" Padding="20">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="Napredek skozi Äas"
                               TextColor="{StaticResource White}"
                               FontSize="18"
                               FontAttributes="Bold"/>

                        <!-- Exercise Selection -->
                        <HorizontalStackLayout Spacing="10">
                            <Button Text="Bench press"
                                    Command="{Binding SelectExerciseCommand}"
                                    CommandParameter="Bench press"
                                    BackgroundColor="{StaticResource Primary}"
                                    TextColor="{StaticResource White}"
                                    CornerRadius="20"
                                    HeightRequest="36"
                                    Padding="15,0"
                                    FontSize="12"/>
                            <Button Text="PoÄep"
                                    Command="{Binding SelectExerciseCommand}"
                                    CommandParameter="PoÄep"
                                    BackgroundColor="{StaticResource Gray600}"
                                    TextColor="{StaticResource Gray400}"
                                    CornerRadius="20"
                                    HeightRequest="36"
                                    Padding="15,0"
                                    FontSize="12"/>
                            <Button Text="Mrtvi dvig"
                                    Command="{Binding SelectExerciseCommand}"
                                    CommandParameter="Mrtvi dvig"
                                    BackgroundColor="{StaticResource Gray600}"
                                    TextColor="{StaticResource Gray400}"
                                    CornerRadius="20"
                                    HeightRequest="36"
                                    Padding="15,0"
                                    FontSize="12"/>
                        </HorizontalStackLayout>

                        <charts:ChartView Chart="{Binding ExerciseChart}" HeightRequest="250" BackgroundColor="Transparent" />
                    </VerticalStackLayout>
                </Frame>
            </VerticalStackLayout>

            <!-- MoÄ View -->
            <VerticalStackLayout IsVisible="{Binding SelectedViewIndex, Converter={StaticResource EqualToConverter}, ConverterParameter=2}" Spacing="15">
                <Frame Style="{StaticResource StrongerCard}" Padding="20">
                    <VerticalStackLayout Spacing="20">
                        <Label Text="Standardi moÄi"
                               TextColor="{StaticResource White}"
                               FontSize="18"
                               FontAttributes="Bold"/>

                        <!-- Bench Press -->
                        <VerticalStackLayout Spacing="10">
                            <Grid ColumnDefinitions="*, Auto">
                                <Label Grid.Column="0" Text="Bench press" TextColor="{StaticResource White}" FontSize="16"/>
                                <Label Grid.Column="1" Text="VaÅ¡ PR: 95 kg" TextColor="{StaticResource Primary}" FontSize="14" FontAttributes="Bold"/>
                            </Grid>
                            <ProgressBar Progress="0.75" ProgressColor="{StaticResource Gold}" HeightRequest="12"/>
                            <Grid ColumnDefinitions="*, *, *, *">
                                <Label Grid.Column="0" Text="ZaÄetnik" TextColor="{StaticResource Gray400}" FontSize="10"/>
                                <Label Grid.Column="1" Text="Vmesni" TextColor="{StaticResource Gray400}" FontSize="10" HorizontalTextAlignment="Center"/>
                                <Label Grid.Column="2" Text="Napredni" TextColor="{StaticResource Gray400}" FontSize="10" HorizontalTextAlignment="Center"/>
                                <Label Grid.Column="3" Text="Elitni" TextColor="{StaticResource Gray400}" FontSize="10" HorizontalTextAlignment="End"/>
                            </Grid>
                        </VerticalStackLayout>

                        <!-- PoÄep -->
                        <VerticalStackLayout Spacing="10">
                            <Grid ColumnDefinitions="*, Auto">
                                <Label Grid.Column="0" Text="PoÄep" TextColor="{StaticResource White}" FontSize="16"/>
                                <Label Grid.Column="1" Text="VaÅ¡ PR: 120 kg" TextColor="{StaticResource Primary}" FontSize="14" FontAttributes="Bold"/>
                            </Grid>
                            <ProgressBar Progress="0.80" ProgressColor="{StaticResource Gold}" HeightRequest="12"/>
                            <Grid ColumnDefinitions="*, *, *, *">
                                <Label Grid.Column="0" Text="ZaÄetnik" TextColor="{StaticResource Gray400}" FontSize="10"/>
                                <Label Grid.Column="1" Text="Vmesni" TextColor="{StaticResource Gray400}" FontSize="10" HorizontalTextAlignment="Center"/>
                                <Label Grid.Column="2" Text="Napredni" TextColor="{StaticResource Gray400}" FontSize="10" HorizontalTextAlignment="Center"/>
                                <Label Grid.Column="3" Text="Elitni" TextColor="{StaticResource Gray400}" FontSize="10" HorizontalTextAlignment="End"/>
                            </Grid>
                        </VerticalStackLayout>

                        <!-- Mrtvi dvig -->
                        <VerticalStackLayout Spacing="10">
                            <Grid ColumnDefinitions="*, Auto">
                                <Label Grid.Column="0" Text="Mrtvi dvig" TextColor="{StaticResource White}" FontSize="16"/>
                                <Label Grid.Column="1" Text="VaÅ¡ PR: 140 kg" TextColor="{StaticResource Primary}" FontSize="14" FontAttributes="Bold"/>
                            </Grid>
                            <ProgressBar Progress="0.85" ProgressColor="{StaticResource Gold}" HeightRequest="12"/>
                            <Grid ColumnDefinitions="*, *, *, *">
                                <Label Grid.Column="0" Text="ZaÄetnik" TextColor="{StaticResource Gray400}" FontSize="10"/>
                                <Label Grid.Column="1" Text="Vmesni" TextColor="{StaticResource Gray400}" FontSize="10" HorizontalTextAlignment="Center"/>
                                <Label Grid.Column="2" Text="Napredni" TextColor="{StaticResource Gray400}" FontSize="10" HorizontalTextAlignment="Center"/>
                                <Label Grid.Column="3" Text="Elitni" TextColor="{StaticResource Gray400}" FontSize="10" HorizontalTextAlignment="End"/>
                            </Grid>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Frame>
            </VerticalStackLayout>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
