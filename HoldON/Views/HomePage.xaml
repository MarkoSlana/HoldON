<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:HoldON.ViewModels"
             xmlns:models="clr-namespace:HoldON.Models"
             x:DataType="viewmodels:HomeViewModel"
             x:Class="HoldON.Views.HomePage"
             BackgroundColor="{StaticResource Background}">
    
    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="20">
            <!-- Header Card -->
            <Frame BackgroundColor="{StaticResource Primary}" 
                   CornerRadius="20" 
                   Padding="20" 
                   HasShadow="False"
                   BorderColor="Transparent">
                <VerticalStackLayout Spacing="15">
                    <Grid ColumnDefinitions="*, Auto">
                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="Pozdravljeni," 
                                   TextColor="#A0C4FF"
                                   FontSize="14"/>
                            <Label Text="{Binding Profile.Name}" 
                                   TextColor="{StaticResource White}" 
                                   FontSize="24" 
                                   FontAttributes="Bold"/>
                        </VerticalStackLayout>
                        <Image Grid.Column="1" 
                               Source="profile_placeholder.png" 
                               HeightRequest="45" 
                               WidthRequest="45">
                            <Image.Clip>
                                <EllipseGeometry RadiusX="22.5" RadiusY="22.5" Center="22.5,22.5"/>
                            </Image.Clip>
                        </Image>
                    </Grid>
                    
                    <Button Text="ZAÄŒNI NOV TRENING" 
                            Command="{Binding StartWorkoutCommand}"
                            BackgroundColor="{StaticResource White}"
                            TextColor="{StaticResource Primary}"
                            CornerRadius="20"
                            HeightRequest="45"
                            FontAttributes="Bold"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Stats Summary Cards -->
            <Grid ColumnDefinitions="*, *" ColumnSpacing="15">
                <Frame Grid.Column="0" Style="{StaticResource StrongerCard}">
                    <VerticalStackLayout Spacing="5">
                        <HorizontalStackLayout Spacing="5">
                            <BoxView Color="{StaticResource Primary}" WidthRequest="8" HeightRequest="8" CornerRadius="4" VerticalOptions="Center"/>
                            <Label Text="Skupaj teÅ¾a" Style="{StaticResource SmallCaption}"/>
                        </HorizontalStackLayout>
                        <Label Text="{Binding TotalVolumeFormatted}" TextColor="{StaticResource White}" FontSize="20" FontAttributes="Bold"/>
                        <Label Text="{Binding WeightProgressPercent}" TextColor="{StaticResource Tertiary}" FontSize="12"/>
                    </VerticalStackLayout>
                </Frame>

                <Frame Grid.Column="1" Style="{StaticResource StrongerCard}">
                    <VerticalStackLayout Spacing="5">
                        <HorizontalStackLayout Spacing="5">
                            <BoxView Color="#FFB703" WidthRequest="8" HeightRequest="8" CornerRadius="4" VerticalOptions="Center"/>
                            <Label Text="Treningi" Style="{StaticResource SmallCaption}"/>
                        </HorizontalStackLayout>
                        <Label Text="{Binding TotalWorkoutsThisMonth}" TextColor="{StaticResource White}" FontSize="20" FontAttributes="Bold"/>
                        <Label Text="{Binding WorkoutsThisWeek, StringFormat='{0} ta teden'}" TextColor="{StaticResource Gray400}" FontSize="12"/>
                    </VerticalStackLayout>
                </Frame>
            </Grid>

            <!-- Rest Timer & Wellness -->
            <Label Text="Regeneracija" Style="{StaticResource SectionHeader}" Margin="0,10,0,0"/>
            <Grid ColumnDefinitions="*, *" ColumnSpacing="15">
                <!-- Rest Timer Card -->
                <Frame Grid.Column="0" Style="{StaticResource StrongerCard}" Padding="15">
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding StartRestTimerCommand}" />
                    </Frame.GestureRecognizers>
                    <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
                        <Label Text="â±" FontSize="24" HorizontalOptions="Center"/>
                        <Label Text="ÄŒasovnik poÄitka" TextColor="{StaticResource Gray400}" FontSize="11" HorizontalTextAlignment="Center"/>
                        <Label Text="{Binding RestTimerDisplay}" TextColor="{StaticResource White}" FontSize="18" FontAttributes="Bold" HorizontalTextAlignment="Center"/>
                        <Button Text="{Binding IsRestTimerRunning, Converter={StaticResource BoolToTextConverter}}"
                                Command="{Binding StopRestTimerCommand}"
                                IsVisible="{Binding IsRestTimerRunning}"
                                BackgroundColor="{StaticResource Danger}"
                                TextColor="{StaticResource White}"
                                FontSize="10"
                                HeightRequest="30"
                                CornerRadius="15"
                                Padding="10,0"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Wellness Card -->
                <Frame Grid.Column="1" Style="{StaticResource StrongerCard}" Padding="15">
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding LogWellnessCommand}" />
                    </Frame.GestureRecognizers>
                    <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
                        <Label Text="ðŸ˜´" FontSize="24" HorizontalOptions="Center"/>
                        <Label Text="PoÄutje/Spanec" TextColor="{StaticResource Gray400}" FontSize="11" HorizontalTextAlignment="Center"/>
                        <Label Text="{Binding TodaysWellness.SleepHours, StringFormat='{0:F1}h spanca'}"
                               TextColor="{StaticResource White}"
                               FontSize="12"
                               HorizontalTextAlignment="Center"
                               IsVisible="{Binding TodaysWellness, Converter={StaticResource IsNotNullConverter}}"/>
                        <Label Text="Ni beleÅ¾eno"
                               TextColor="{StaticResource Gray400}"
                               FontSize="12"
                               HorizontalTextAlignment="Center"
                               IsVisible="{Binding TodaysWellness, Converter={StaticResource IsNullConverter}}"/>
                        <HorizontalStackLayout Spacing="2" HorizontalOptions="Center" IsVisible="{Binding TodaysWellness, Converter={StaticResource IsNotNullConverter}}">
                            <Label Text="ðŸ˜Š" FontSize="14"/>
                            <Label Text="{Binding TodaysWellness.MoodRating, StringFormat='{0}/5'}" TextColor="{StaticResource Tertiary}" FontSize="11"/>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </Frame>
            </Grid>

            <!-- Moj program -->
            <Label Text="Moj program" Style="{StaticResource SectionHeader}" Margin="0,20,0,0"/>
            <Frame Style="{StaticResource StrongerCard}" Padding="20">
                <Frame.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding ViewWorkoutPlanCommand}" />
                </Frame.GestureRecognizers>
                <VerticalStackLayout Spacing="15">
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="ðŸ“‹" FontSize="28"/>
                        <VerticalStackLayout Spacing="2" VerticalOptions="Center">
                            <Label Text="{Binding CurrentWorkoutPlan.Name}"
                                   TextColor="{StaticResource White}"
                                   FontSize="16"
                                   FontAttributes="Bold"/>
                            <Label Text="{Binding CurrentWorkoutPlan.Goal}"
                                   TextColor="{StaticResource Gray400}"
                                   FontSize="12"/>
                        </VerticalStackLayout>
                    </HorizontalStackLayout>

                    <BoxView HeightRequest="1" BackgroundColor="{StaticResource Gray600}"/>

                    <Grid ColumnDefinitions="Auto, *" ColumnSpacing="10">
                        <Label Grid.Column="0"
                               Text="ðŸ—“"
                               FontSize="20"
                               VerticalOptions="Center"/>
                        <VerticalStackLayout Grid.Column="1" Spacing="2">
                            <Label Text="Danes"
                                   TextColor="{StaticResource Gray400}"
                                   FontSize="11"/>
                            <Label Text="{Binding TodaysWorkoutSummary}"
                                   TextColor="{StaticResource Primary}"
                                   FontSize="14"
                                   FontAttributes="Bold"/>
                        </VerticalStackLayout>
                    </Grid>

                    <Button Text="Poglej celoten program"
                            Command="{Binding ViewWorkoutPlanCommand}"
                            BackgroundColor="{StaticResource Primary}"
                            TextColor="{StaticResource White}"
                            CornerRadius="15"
                            HeightRequest="40"
                            FontSize="12"
                            FontAttributes="Bold"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Zgodovina treningov -->
            <Frame Style="{StaticResource StrongerCard}" Padding="20" Margin="0,10,0,0">
                <Frame.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding ViewWorkoutHistoryCommand}" />
                </Frame.GestureRecognizers>
                <Grid ColumnDefinitions="Auto, *, Auto">
                    <Label Grid.Column="0"
                           Text="ðŸ“Š"
                           FontSize="28"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>
                    <VerticalStackLayout Grid.Column="1" Spacing="2" VerticalOptions="Center">
                        <Label Text="Zgodovina treningov"
                               TextColor="{StaticResource White}"
                               FontSize="16"
                               FontAttributes="Bold"/>
                        <Label Text="Pregled vseh shranjenih treningov"
                               TextColor="{StaticResource Gray400}"
                               FontSize="12"/>
                    </VerticalStackLayout>
                    <Label Grid.Column="2"
                           Text="â€º"
                           TextColor="{StaticResource Primary}"
                           FontSize="24"
                           VerticalOptions="Center"/>
                </Grid>
            </Frame>

            <!-- DoseÅ¾ki -->
            <Grid ColumnDefinitions="*, Auto" Margin="0,10,0,0">
                <Label Grid.Column="0" Text="DoseÅ¾ki" Style="{StaticResource SectionHeader}"/>
                <Label Grid.Column="1" Text="Poglej vse â€º" TextColor="{StaticResource Primary}" FontSize="12" VerticalOptions="Center"/>
            </Grid>
            <ScrollView Orientation="Horizontal" HorizontalScrollBarVisibility="Never">
                <HorizontalStackLayout Spacing="15">
                    <Frame BackgroundColor="{StaticResource Orange}" CornerRadius="15" WidthRequest="110" HeightRequest="130" Padding="15" HasShadow="False">
                        <VerticalStackLayout Spacing="8" VerticalOptions="Center">
                            <Label Text="ðŸ”¥" FontSize="32" HorizontalOptions="Center"/>
                            <Label Text="7 dni" TextColor="White" FontSize="18" FontAttributes="Bold" HorizontalTextAlignment="Center"/>
                        </VerticalStackLayout>
                    </Frame>
                    <Frame BackgroundColor="{StaticResource Purple}" CornerRadius="15" WidthRequest="110" HeightRequest="130" Padding="15" HasShadow="False">
                        <VerticalStackLayout Spacing="8" VerticalOptions="Center">
                            <Label Text="ðŸ’ª" FontSize="32" HorizontalOptions="Center"/>
                            <Label Text="Novi PR" TextColor="White" FontSize="18" FontAttributes="Bold" HorizontalTextAlignment="Center"/>
                        </VerticalStackLayout>
                    </Frame>
                    <Frame BackgroundColor="{StaticResource Gold}" CornerRadius="15" WidthRequest="110" HeightRequest="130" Padding="15" HasShadow="False">
                        <VerticalStackLayout Spacing="8" VerticalOptions="Center">
                            <Label Text="ðŸ†" FontSize="32" HorizontalOptions="Center"/>
                            <Label Text="50" TextColor="White" FontSize="18" FontAttributes="Bold" HorizontalTextAlignment="Center"/>
                            <Label Text="treningov" TextColor="White" FontSize="12" HorizontalTextAlignment="Center"/>
                        </VerticalStackLayout>
                    </Frame>
                </HorizontalStackLayout>
            </ScrollView>

            <!-- Osebni rekordi -->
            <Label Text="Osebni rekordi" Style="{StaticResource SectionHeader}" Margin="0,20,0,0"/>
            <VerticalStackLayout Spacing="10">
                <Frame Style="{StaticResource StrongerCard}">
                    <Grid ColumnDefinitions="*, Auto, Auto" ColumnSpacing="15">
                        <VerticalStackLayout Grid.Column="0" Spacing="5">
                            <Label Text="Bench press" TextColor="{StaticResource White}" FontSize="14"/>
                            <Label Text="95 kg" TextColor="{StaticResource White}" FontSize="24" FontAttributes="Bold"/>
                        </VerticalStackLayout>
                        <Label Grid.Column="1" Text="+5 kg" TextColor="{StaticResource Tertiary}" FontSize="12" VerticalOptions="End"/>
                        <Label Grid.Column="2" Text="ðŸ†" FontSize="24" VerticalOptions="Center"/>
                    </Grid>
                </Frame>
                <Frame Style="{StaticResource StrongerCard}">
                    <Grid ColumnDefinitions="*, Auto, Auto" ColumnSpacing="15">
                        <VerticalStackLayout Grid.Column="0" Spacing="5">
                            <Label Text="PoÄep" TextColor="{StaticResource White}" FontSize="14"/>
                            <Label Text="120 kg" TextColor="{StaticResource White}" FontSize="24" FontAttributes="Bold"/>
                        </VerticalStackLayout>
                        <Label Grid.Column="1" Text="+10 kg" TextColor="{StaticResource Tertiary}" FontSize="12" VerticalOptions="End"/>
                        <Label Grid.Column="2" Text="ðŸ†" FontSize="24" VerticalOptions="Center"/>
                    </Grid>
                </Frame>
                <Frame Style="{StaticResource StrongerCard}">
                    <Grid ColumnDefinitions="*, Auto, Auto" ColumnSpacing="15">
                        <VerticalStackLayout Grid.Column="0" Spacing="5">
                            <Label Text="Mrtvi dvig" TextColor="{StaticResource White}" FontSize="14"/>
                            <Label Text="140 kg" TextColor="{StaticResource White}" FontSize="24" FontAttributes="Bold"/>
                        </VerticalStackLayout>
                        <Label Grid.Column="1" Text="+15 kg" TextColor="{StaticResource Tertiary}" FontSize="12" VerticalOptions="End"/>
                        <Label Grid.Column="2" Text="ðŸ†" FontSize="24" VerticalOptions="Center"/>
                    </Grid>
                </Frame>
            </VerticalStackLayout>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>